<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Visibility System Test</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .mode-button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-button.active {
            background: #3b82f6;
            color: white;
        }
        
        .mode-button:not(.active) {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .mode-button:hover:not(.active) {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .components-container {
            display: grid;
            gap: 20px;
        }
        
        .component {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .component.visible {
            border-color: #10b981;
        }
        
        .component.hidden {
            border-color: #ef4444;
            opacity: 0.6;
        }
        
        .component-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .component-title {
            font-size: 18px;
            font-weight: bold;
        }
        
        .visibility-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .visibility-badge.visible {
            background: #10b981;
            color: white;
        }
        
        .visibility-badge.hidden {
            background: #ef4444;
            color: white;
        }
        
        .component-content {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }
        
        .status-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .info-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        
        .info-card h3 {
            margin-top: 0;
            color: #60a5fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé≠ Component Visibility System Test</h1>
            <p>Simulates how the DynamicPageRenderer handles component visibility</p>
        </div>
        
        <div class="status-info">
            <div><strong>Current Mode:</strong> <span id="currentMode">View Mode</span></div>
            <div><strong>Total Components:</strong> <span id="totalComponents">5</span></div>
            <div><strong>Visible Components:</strong> <span id="visibleComponents">3</span></div>
            <div><strong>Hidden Components:</strong> <span id="hiddenComponents">2</span></div>
        </div>
        
        <div class="mode-selector">
            <button class="mode-button active" onclick="switchMode('view')">
                üëÅÔ∏è View Mode (Public)
            </button>
            <button class="mode-button" onclick="switchMode('edit')">
                üîß Edit Mode (Admin)
            </button>
        </div>
        
        <div class="components-container" id="componentsContainer">
            <!-- Components will be rendered here -->
        </div>
        
        <div class="info-grid">
            <div class="info-card">
                <h3>üéØ View Mode Behavior</h3>
                <ul>
                    <li>Only shows components with <code>isVisible: true</code></li>
                    <li>Hidden components are completely filtered out</li>
                    <li>Improves page load performance</li>
                    <li>Better user experience</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>üîß Edit Mode Behavior</h3>
                <ul>
                    <li>Shows ALL components regardless of visibility</li>
                    <li>Allows admins to toggle visibility</li>
                    <li>Hidden components are visually indicated</li>
                    <li>Enables full page management</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>‚úÖ Implementation Benefits</h3>
                <ul>
                    <li>Respects <code>isVisible</code> API property</li>
                    <li>Mode-aware rendering logic</li>
                    <li>Performance optimized loading</li>
                    <li>Admin-friendly interface</li>
                </ul>
            </div>
            
            <div class="info-card">
                <h3>üîç Technical Details</h3>
                <ul>
                    <li>Uses <code>isEditMode()</code> detection</li>
                    <li>Filters before component mapping</li>
                    <li>Console logging for debugging</li>
                    <li>Proper error handling</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Mock component data
        const components = [
            {
                id: 1,
                componentName: "Hero Section",
                componentType: "HeroSection",
                isVisible: true,
                content: "Welcome to our amazing product! This hero section introduces users to our platform."
            },
            {
                id: 2,
                componentName: "Features Section", 
                componentType: "FeaturesSection",
                isVisible: false,
                content: "This section showcases our key features but is currently hidden from public view."
            },
            {
                id: 3,
                componentName: "About Section",
                componentType: "AboutSection", 
                isVisible: true,
                content: "Learn more about our company and mission in this informative section."
            },
            {
                id: 4,
                componentName: "Pricing Section",
                componentType: "PricingSection",
                isVisible: false,
                content: "Our pricing plans are displayed here, but currently hidden during development."
            },
            {
                id: 5,
                componentName: "Contact Section",
                componentType: "ContactSection",
                isVisible: true,
                content: "Get in touch with us through this contact form section."
            }
        ];
        
        let currentMode = 'view';
        
        function switchMode(mode) {
            currentMode = mode;
            
            // Update button states
            document.querySelectorAll('.mode-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update mode display
            document.getElementById('currentMode').textContent = 
                mode === 'edit' ? 'Edit Mode (Admin)' : 'View Mode (Public)';
            
            // Re-render components
            renderComponents();
            
            console.log(`üîÑ Switched to ${mode} mode`);
        }
        
        function renderComponents() {
            // Simulate the DynamicPageRenderer logic
            const inEditMode = currentMode === 'edit';
            
            let componentsToRender;
            if (inEditMode) {
                console.log("üîß [EDIT MODE] Showing all components including hidden ones");
                componentsToRender = components;
            } else {
                componentsToRender = components.filter(component => {
                    const isVisible = component.isVisible === true;
                    if (!isVisible) {
                        console.log(`üëÅÔ∏è [VISIBILITY] Hiding component: ${component.componentName} (isVisible: ${component.isVisible})`);
                    }
                    return isVisible;
                });
                console.log(`üëÅÔ∏è [VISIBILITY] Showing ${componentsToRender.length} out of ${components.length} components in view mode`);
            }
            
            // Update counters
            const visibleCount = components.filter(c => c.isVisible).length;
            const hiddenCount = components.length - visibleCount;
            
            document.getElementById('totalComponents').textContent = components.length;
            document.getElementById('visibleComponents').textContent = visibleCount;
            document.getElementById('hiddenComponents').textContent = hiddenCount;
            
            // Render components
            const container = document.getElementById('componentsContainer');
            container.innerHTML = '';
            
            if (componentsToRender.length === 0) {
                container.innerHTML = `
                    <div class="component">
                        <div class="component-header">
                            <div class="component-title">üìÑ No Components Found</div>
                        </div>
                        <div class="component-content">
                            ${inEditMode 
                                ? "This page doesn't have any components yet."
                                : "This page doesn't have any visible components. Check component visibility settings in the admin panel."
                            }
                        </div>
                    </div>
                `;
                return;
            }
            
            componentsToRender.forEach(component => {
                const isVisible = component.isVisible;
                const componentEl = document.createElement('div');
                componentEl.className = `component ${isVisible ? 'visible' : 'hidden'}`;
                
                componentEl.innerHTML = `
                    <div class="component-header">
                        <div class="component-title">${component.componentName}</div>
                        <div class="visibility-badge ${isVisible ? 'visible' : 'hidden'}">
                            ${isVisible ? '‚úÖ Visible' : '‚ùå Hidden'}
                        </div>
                    </div>
                    <div class="component-content">
                        <strong>Type:</strong> ${component.componentType}<br>
                        <strong>Content:</strong> ${component.content}
                        ${!inEditMode && !isVisible ? '<br><em>This component would be hidden in view mode.</em>' : ''}
                    </div>
                `;
                
                container.appendChild(componentEl);
            });
        }
        
        // Initial render
        renderComponents();
        
        console.log('üé≠ Component Visibility System Test Loaded');
        console.log('üîÑ Switch between Edit and View modes to see the difference');
    </script>
</body>
</html>